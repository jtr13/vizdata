--- 
title: "Dataset guide"
author: "Joyce Robbins"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
---

```{r}
knitr::opts_chunk$set(message = FALSE, warning = FALSE, echo = FALSE,
                      results = 'asis')
```

```{r}
library(magrittr)
get_data <- function(packagename) {
    file <- paste0("data/", packagename)
    if (file.exists(file)) {
    pkgdata <- readRDS(file)
  } else {
    pkgdata <- datacat::data_xray(packagename, link = TRUE)
    saveRDS(pkgdata, file = file)
  }
}

show_data <- function(data, targets = c(1, 5, 10:12)) {
 DT::datatable(data, escape = FALSE, filter = 'top',
                  options = list(columnDefs = list(list(targets = targets, 
                                                        visible = FALSE)),
                                 buttons = c('colvis'), dom = 'Bfrtip'),
                  extensions = 'Buttons') 
}


show <- function(packagename) {
  cat(packageDescription(packagename)$Description)
  get_data(packagename) %>% show_data()
}
```

# Introduction

### Guide to tables

The tables in the following chapters provide detailed information about datasets in R packages. The complete list of output columns is as follows. Columns not initially visible can be viewed by clicking the `Column Visibility` button.


```{r}
# https://haozhu233.github.io/kableExtra/bookdown/use-bootstrap-tables-in-gitbooks-epub.html#gitbook
options(kableExtra.html.bsTable = T)

# *** Keep output columns in datacat's README.md up to date! ***

`Output columns` <- readLines("https://raw.githubusercontent.com/jtr13/datacat/master/README.md") %>% 
  stringr::str_extract("^\\*.*$") %>% 
  na.omit() %>% 
  stringr::str_remove_all("\\* ")
  
tibble::tibble(`Output columns`) %>% knitr::kable(format="html") %>% 
  kableExtra::kable_styling(bootstrap_options = "basic")
```

Table columns can be sorted and filtered. Dataset names are linked to documentation if available. Datasets without links are usually included in documentation for a dataset in the same package with a similar name. For example, documentation for `alr4::BGSboys` and `alr4::BGSgirls` is included on the help page for `alr4::BGSall`.


### Exploring data in packages locally

The main function used here is `data_xray()` from the **datacat** package. You can explore datasets in R packages locally as follows.

Install **datacat**:

```{r, eval = FALSE, echo = TRUE}
remotes::install_github("jtr13/datacat")
```

View information with:

```{r, eval = FALSE, echo = TRUE}
library(datacat)
data_xray("ggplot2") %>% View()
```


